<import from="./summon"></import>
<!-- <import from="./effect"></import> -->
<import from="./othercharac"></import>

<!-- Spell Description -->
<div class="spellDescription" if.bind="spell">
	<!-- name -->
	<h5 if.bind="!issummon">${name}</h5>
	<h6 if.bind="issummon">
		<img src="${db.getSpellIconPath(spellid)}" style="width: 28px; height: 28px;" />
		${name} 
	</h6>
	
	<span>
		${spell.apCost} <span t="pa"></span> <span style.bind="db.getModIconStyle(' pa ') + 'display: inline-block;'"></span> /
	</span>
	<span>
		${spell.minRange} - ${spell.range} <span t="po"></span> 
		<img if.bind="spell.rangeCanBeBoosted" src="${db.getIconPath('icons/editable_range.webp')}"/>
		<img if.bind="!spell.rangeCanBeBoosted" src="${db.getIconPath('icons/fixed_range.webp')}"/>
	</span>

	<!-- description -->
	<p style="white-space: pre-line;" innerhtml.bind="description"></p>

	<!-- effects -->
	<div class="d-flex effects">
		<!-- normal -->
		<div class="effectsNormal">
			<h6 t="effects"></h6>
			<table class="table table-striped table-sm table-borderless">
				<tbody>
					<tr repeat.for="e of spell.effects"  if.bind="e.visibleInTooltip"> <!-- || e.effect.showInTooltip -->
						<!--  if.bind="e.visibleInTooltip" -->
						<td style="padding: 0px;">
							<table class="table table-striped table-sm table-borderless" style="--bs-table-striped-bg: none; margin-bottom: 0px;">
								<tbody>
									<tr>
										<td style="width: 20px; padding: 0px; padding-left: 4px;" if.bind="getIcon(e)">
											<div style.bind="getIcon(e)"></div>
										</td>
										<td style="vertical-align: middle;" innerHtml.bind="renderEffectI18n(e)"></td>
										<td if.bind="isDuration(e)" style.bind="getDispellIcon(e)" ></td>
										<td repeat.for="t of getTargets(e)" if.bind="getTargetIcon(t)" style.bind="getTargetIcon(t)"></td>
										<td if.bind="db.getAoeIconStyle(e)" style.bind="db.getAoeIconStyle(e)"></td>
									</tr>
								</tbody>
							</table>
							<table if.bind="hasTrapGlyph(e)" class="table table-striped table-sm table-borderless" style="--bs-table-striped-bg: none; margin-bottom: 0px;">
								<tbody>
									<tr>
										<td style="vertical-align: middle; padding: 0px;" innerHtml.bind="renderTrapGlyph(e)" colspan="4"></td>
									</tr>
								</tbody>
							</table>
						</td>
					</tr>

				</tbody>
			</table>
		</div>
		<!-- critiques -->
		<div class="effectsCrit">
			<h6 t="effectsCrit"></h6>
			<table class="table table-striped table-sm table-borderless ">
				<tbody>
					<tr repeat.for="e of spell.criticalEffect" if.bind="e.visibleInTooltip">
						<td style="padding: 0px;">
							<table class="table table-striped table-sm table-borderless" style="--bs-table-striped-bg: none; margin-bottom: 0px;">
								<tbody>
									<tr>
										<td style="width: 20px; padding: 0px; padding-left: 4px;" if.bind="getIcon(e)">
											<div style.bind="getIcon(e)"></div>
										</td>
										<td style="vertical-align: middle;" innerHtml.bind="renderEffectI18n(e)"></td>
										<td if.bind="isDuration(e)" style.bind="getDispellIcon(e)"></td>
										<td repeat.for="t of getTargets(e)" if.bind="getTargetIcon(t)" style.bind="getTargetIcon(t)"></td>
										<td if.bind="db.getAoeIconStyle(e)" style.bind="db.getAoeIconStyle(e)"></td>
									</tr>
								</tbody>
							</table>
							<table if.bind="hasTrapGlyph(e)" class="table table-striped table-sm table-borderless" style="--bs-table-striped-bg: none; margin-bottom: 0px;">
								<tbody>
									<tr>
										<td style="vertical-align: middle; padding: 0px;" innerHtml.bind="renderTrapGlyph(e)" colspan="4"></td>
									</tr>
								</tbody>
							</table>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

	<!-- other -->
	<div>
		<othercharac spellid.bind="spellid" spell.bind="spell"></othercharac>
	</div> 

	<!-- détails additionels -->
	<!-- <div if.bind="detailsObj.text">
		<h6>Détails additionnels</h6>
		<p if.bind="detailsObj.text">${detailsObj.text}</p>
	</div> -->

</div> <!-- fin info sort -->


<!-- Invoc -->
<div if.bind="db.isLoaded" repeat.for="e1 of spell.effects">
	<summon if.bind="hasSummon(e1)" summon.bind="getSummon(e1)" side.bind="e1.diceSide"></summon>
</div>


<!-- <div if.bind="db.isLoaded" repeat.for="e1 of spell.effects">
	<summon if.bind="hasSummon(e1)" summon.bind="getSummon(e1)" side.bind="e1.diceSide"></summon>
</div> -->
